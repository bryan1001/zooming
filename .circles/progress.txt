## Codebase Patterns
- Canvas element is in index.html with id="canvas"
- Three.js scene, camera, and renderer are initialized in src/main.ts
- Styles go in src/style.css with fullscreen canvas setup
- Use MeshStandardMaterial for objects that need lighting
- City-related modules go in src/city/ directory
- Use seeded random (mulberry32) for reproducible procedural generation
- Run `npm run typecheck` to verify TypeScript passes
- CHUNK_SIZE is 200 units (exported from chunk.ts), use for chunk management calculations
- ChunkManager handles dynamic chunk loading/unloading based on camera position
- Use deltaTime pattern: const delta = (performance.now() - lastTime) / 1000 for frame-rate independent updates
- Dispose geometry/materials when removing objects: mesh.geometry.dispose(); mesh.material.dispose()

---

## 2026-02-02 - US-001
- What was implemented:
  - Initialized Vite + TypeScript project
  - Installed Three.js and @types/three
  - Created index.html with canvas element
  - Created main.ts with basic Three.js scene (rotating cube, lighting)
  - Configured fullscreen canvas styling
- Files changed:
  - index.html (canvas element)
  - src/main.ts (Three.js scene setup)
  - src/style.css (fullscreen canvas styles)
  - package.json (added three, @types/three)
- **Learnings for future iterations:**
  - Vite uses vanilla-ts template for TypeScript projects
  - Three.js requires both three and @types/three packages
  - Canvas needs display:block to prevent scrollbars
  - MeshStandardMaterial requires lighting to be visible
  - Run `npm run typecheck` to verify TypeScript (script added to package.json)
---

## 2026-02-02 - US-002
- What was implemented:
  - Created src/city/building.ts module with createBuilding function
  - Buildings use seeded random number generator for reproducible randomness
  - Building dimensions: height 10-100 units, width/depth 5-20 units
  - Buildings positioned with base at y=0
  - Added typecheck script to package.json
- Files changed:
  - src/city/building.ts (new file - building generator)
  - package.json (added typecheck script)
- **Learnings for future iterations:**
  - Use seeded random (mulberry32) for reproducible procedural generation
  - Position meshes by setting y to half the height for floor-aligned objects
  - City-related modules go in src/city/ directory
---

## 2026-02-02 - US-003
- What was implemented:
  - Created src/city/chunk.ts module with createChunk function
  - Chunk is a 200x200 unit area (CHUNK_SIZE constant exported)
  - Buildings placed in a grid pattern with 25-unit blocks (provides street gaps)
  - Uses hashPosition() for reproducible building seeds based on world coordinates
  - Chunk stores its coordinates in userData for identification
- Files changed:
  - src/city/chunk.ts (new file - chunk generator)
- **Learnings for future iterations:**
  - CHUNK_SIZE is 200 units, exported for use by other modules
  - Block size of 25 units provides room for buildings (5-20 units) plus street gaps
  - Use hashPosition() pattern to generate unique seeds from world coordinates
  - Store chunk identification in Group.userData for later management
  - Grid layout: blocksPerSide = floor(CHUNK_SIZE / BLOCK_SIZE) = 8 buildings per axis
---

## 2026-02-02 - US-004
- What was implemented:
  - Created src/city/chunkManager.ts module with ChunkManager class
  - Tracks loaded chunks in a Map using "chunkX,chunkZ" keys
  - Generates chunks 3 ahead of camera and keeps 2 behind in Z direction
  - Loads chunks laterally (2 on each side) for visibility
  - Removes chunks beyond view and disposes of geometry/materials to free memory
  - Updated main.ts to use ChunkManager and enable camera movement
  - Camera positioned at street level (y=30) moving forward at 50 units/sec
  - Increased far plane to 2000 for distant chunk visibility
- Files changed:
  - src/city/chunkManager.ts (new file - chunk loading/unloading manager)
  - src/main.ts (integrated ChunkManager, removed demo cube, added camera movement)
- **Learnings for future iterations:**
  - Use Map with string keys for chunk tracking (e.g., "chunkX,chunkZ")
  - worldToChunk: Math.floor(worldPos / CHUNK_SIZE) converts world to chunk coords
  - Dispose geometry and materials when removing chunks to prevent memory leaks
  - Use performance.now() and deltaTime for frame-rate independent movement
  - Camera far plane needs to be large enough to see distant chunks (2000+ units)
  - Camera y=30 provides good street-level view of buildings
---
